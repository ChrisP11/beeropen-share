{% extends "base.html" %}

{% block title %}Hole {{ hole }} · Beer Open{% endblock %}

{% block content %}
<div class="container py-4" style="max-width: 720px;">
  <h1 class="mb-1">Hole {{ hole }}</h1>
  <div class="text-muted mb-3">{{ round.team.name }}</div>

  <div class="row g-3">
    <div class="col-6">
      <div class="card h-100">
        <div class="card-body">
          <div class="fw-bold text-muted">Yardage</div>
          <div class="display-6">
            {{ yardage }}
            {% if tee_cue %}
                <span class="badge bg-primary align-middle ms-2">{{ tee_cue }}</span>
            {% endif %}
            </div>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="card h-100">
        <div class="card-body">
          <div class="fw-bold text-muted">Par</div>
          <div class="display-6">{{ par }}</div>
        </div>
      </div>
    </div>
  </div>

  <hr class="my-4">

  <form method="post" class="mt-2">
    {% csrf_token %}

    <!-- Hole Score: dropdown 1–9 (default 4) -->
    <label for="strokes" class="form-label fw-bold">Hole Score</label>
    <select class="form-select" id="strokes" name="strokes" {% if not can_edit %}disabled{% endif %}>
      {% with sel=selected_strokes %}
        {% for _ in "123456789" %}
          {% with val=forloop.counter %}
            <option value="{{ val }}"{% if sel == val %} selected{% endif %}>{{ val }}</option>
          {% endwith %}
        {% endfor %}
      {% endwith %}
    </select>
    {% if not can_edit %}
      <div class="form-text">This scorecard is locked or you don’t have edit permission.</div>
    {% endif %}

    <div class="mt-4">
      <label for="drive_pid" class="form-label fw-bold">Drive used</label>
      <select class="form-select" id="drive_pid" name="drive_pid" {% if not can_edit %}disabled{% endif %}>
        <option value="">—</option>
        {% for p in players %}
          <option value="{{ p.id }}"{% if current_drive_pid == p.id %} selected{% endif %}>
            {{ p.first_name }} {{ p.last_name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="d-flex gap-2 mt-4">
      {% if can_edit %}
        <!-- Save: advances to next hole (except 9 & 18 go to scorecard) -->
        <button class="btn btn-primary" type="submit" name="go" value="save">Save</button>
        <!-- Scorecard: always return to scorecard -->
        <button class="btn btn-outline-primary" type="submit" name="go" value="card">Scorecard</button>
      {% endif %}
    </div>
  </form>
</div>
{% endblock %}
